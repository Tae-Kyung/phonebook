<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAT Îç∞Ïù¥ÌÑ∞ Îã§Ï∞®Ïõê Î∂ÑÏÑù</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #eee;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: #aaa;
            margin-top: 10px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .filter-section {
            margin-bottom: 25px;
        }

        .filter-section h3 {
            color: #00d2ff;
            margin-bottom: 15px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 0.9rem;
        }

        .filter-group select,
        .filter-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 0.9rem;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #00d2ff;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .checkbox-item:hover {
            background: rgba(0,210,255,0.2);
        }

        .checkbox-item input {
            accent-color: #00d2ff;
        }

        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            color: #fff;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,210,255,0.4);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .stat-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-card .label {
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .chart-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .chart-card.full-width {
            grid-column: 1 / -1;
        }

        .chart-card h3 {
            color: #00d2ff;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .chart-container.tall {
            height: 400px;
        }

        .data-table-container {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            overflow-x: auto;
        }

        .data-table-container h3 {
            color: #00d2ff;
            margin-bottom: 15px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .data-table th {
            background: rgba(0,210,255,0.1);
            color: #00d2ff;
            font-weight: 600;
            cursor: pointer;
        }

        .data-table th:hover {
            background: rgba(0,210,255,0.2);
        }

        .data-table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .pagination button {
            padding: 8px 15px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.3);
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pagination button:hover,
        .pagination button.active {
            background: rgba(0,210,255,0.3);
            border-color: #00d2ff;
        }

        .correlation-matrix {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 20px;
        }

        .corr-cell {
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            font-weight: bold;
        }

        .corr-header {
            background: rgba(0,210,255,0.2);
            color: #00d2ff;
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            background: rgba(255,255,255,0.05);
            border: none;
            border-radius: 8px;
            color: #aaa;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(90deg, #00d2ff, #3a7bd5);
            color: #fff;
        }

        .tab:hover:not(.active) {
            background: rgba(255,255,255,0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .insight-card {
            background: rgba(0,210,255,0.1);
            border-left: 4px solid #00d2ff;
            padding: 15px;
            border-radius: 0 8px 8px 0;
            margin-bottom: 15px;
        }

        .insight-card h4 {
            color: #00d2ff;
            margin-bottom: 8px;
        }

        .insight-card p {
            color: #ccc;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .legend-custom {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
            color: #ccc;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .stats-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SAT Îç∞Ïù¥ÌÑ∞ Îã§Ï∞®Ïõê Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú</h1>
            <p>Ï∂©Î∂ÅÎåÄ Ïù∏Í≥µÏßÄÎä• ÌôúÏö© Ïã§Ïäµ Í≥ºÏ†ú</p>
        </header>

        <div class="dashboard">
            <aside class="sidebar">
                <div class="filter-section">
                    <h3>üìä Î∂ÑÏÑù Ï∞®Ïõê ÏÑ†ÌÉù</h3>

                    <div class="filter-group">
                        <label>Ï£ºÏöî Î∂ÑÏÑù Í∏∞Ï§Ä</label>
                        <select id="primaryDimension">
                            <option value="gender">ÏÑ±Î≥Ñ</option>
                            <option value="race_ethnicity">Ïù∏Ï¢Ö/ÎØºÏ°±</option>
                            <option value="parental_level_of_education">Î∂ÄÎ™® ÍµêÏú°ÏàòÏ§Ä</option>
                            <option value="lunch">Ï†êÏã¨ Ïú†Ìòï</option>
                            <option value="test_preparation_course">ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ï</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>Ï†êÏàò Ïú†Ìòï</label>
                        <select id="scoreType">
                            <option value="all">Ï†ÑÏ≤¥ Ï†êÏàò</option>
                            <option value="math_score">ÏàòÌïô</option>
                            <option value="reading_score">ÏùΩÍ∏∞</option>
                            <option value="writing_score">Ïì∞Í∏∞</option>
                        </select>
                    </div>
                </div>

                <div class="filter-section">
                    <h3>üîç ÌïÑÌÑ∞</h3>

                    <div class="filter-group">
                        <label>ÏÑ±Î≥Ñ</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-male" checked> ÎÇ®ÏÑ±
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-female" checked> Ïó¨ÏÑ±
                            </label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label>Ïù∏Ï¢Ö/ÎØºÏ°±</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" class="race-filter" value="group A" checked> A
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" class="race-filter" value="group B" checked> B
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" class="race-filter" value="group C" checked> C
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" class="race-filter" value="group D" checked> D
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" class="race-filter" value="group E" checked> E
                            </label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label>Ï†êÏã¨ Ïú†Ìòï</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-standard" checked> ÏùºÎ∞ò
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-reduced" checked> Î¨¥Î£å/Ìï†Ïù∏
                            </label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label>ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ï</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-prep-completed" checked> ÏôÑÎ£å
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="filter-prep-none" checked> ÎØ∏ÏàòÍ∞ï
                            </label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <label>Ï†êÏàò Î≤îÏúÑ</label>
                        <input type="range" id="scoreMin" min="0" max="100" value="0">
                        <span id="scoreMinLabel">ÏµúÏÜå: 0</span>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="applyFilters()">ÌïÑÌÑ∞ Ï†ÅÏö©</button>
                <button class="btn btn-secondary" onclick="resetFilters()">Ï¥àÍ∏∞Ìôî</button>
            </aside>

            <main class="main-content">
                <div class="stats-row">
                    <div class="stat-card">
                        <div class="value" id="totalStudents">0</div>
                        <div class="label">Ï¥ù ÌïôÏÉù Ïàò</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="avgMath">0</div>
                        <div class="label">ÌèâÍ∑† ÏàòÌïô Ï†êÏàò</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="avgReading">0</div>
                        <div class="label">ÌèâÍ∑† ÏùΩÍ∏∞ Ï†êÏàò</div>
                    </div>
                    <div class="stat-card">
                        <div class="value" id="avgWriting">0</div>
                        <div class="label">ÌèâÍ∑† Ïì∞Í∏∞ Ï†êÏàò</div>
                    </div>
                </div>

                <div class="tab-container">
                    <button class="tab active" onclick="showTab('overview')">Í∞úÏöî</button>
                    <button class="tab" onclick="showTab('comparison')">ÎπÑÍµê Î∂ÑÏÑù</button>
                    <button class="tab" onclick="showTab('correlation')">ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ</button>
                    <button class="tab" onclick="showTab('insights')">Ïù∏ÏÇ¨Ïù¥Ìä∏</button>
                    <button class="tab" onclick="showTab('data')">Îç∞Ïù¥ÌÑ∞</button>
                </div>

                <div id="overview" class="tab-content active">
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>üìä Ï∞®ÏõêÎ≥Ñ ÌèâÍ∑† Ï†êÏàò</h3>
                            <div class="chart-container">
                                <canvas id="dimensionChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>ü•ß Ï∞®ÏõêÎ≥Ñ ÌïôÏÉù Î∂ÑÌè¨</h3>
                            <div class="chart-container">
                                <canvas id="distributionPie"></canvas>
                            </div>
                        </div>

                        <div class="chart-card full-width">
                            <h3>üìà Ï†êÏàò Î∂ÑÌè¨ ÌûàÏä§ÌÜ†Í∑∏Îû®</h3>
                            <div class="chart-container tall">
                                <canvas id="histogramChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="comparison" class="tab-content">
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>üë• ÏÑ±Î≥Ñ Ï†êÏàò ÎπÑÍµê</h3>
                            <div class="chart-container">
                                <canvas id="genderChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>üéì Î∂ÄÎ™® ÍµêÏú°ÏàòÏ§ÄÎ≥Ñ Ï†êÏàò</h3>
                            <div class="chart-container">
                                <canvas id="educationChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>üçΩÔ∏è Ï†êÏã¨ Ïú†ÌòïÎ≥Ñ Ï†êÏàò</h3>
                            <div class="chart-container">
                                <canvas id="lunchChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>üìö ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ï ÏòÅÌñ•</h3>
                            <div class="chart-container">
                                <canvas id="prepChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card full-width">
                            <h3>üåç Ïù∏Ï¢Ö/ÎØºÏ°±Î≥Ñ Ï†êÏàò Î∂ÑÏÑù</h3>
                            <div class="chart-container tall">
                                <canvas id="raceChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="correlation" class="tab-content">
                    <div class="charts-grid">
                        <div class="chart-card full-width">
                            <h3>üîó Ï†êÏàò Í∞Ñ ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ</h3>
                            <div class="chart-container tall">
                                <canvas id="scatterChart"></canvas>
                            </div>
                            <div class="legend-custom" id="scatterLegend"></div>
                        </div>

                        <div class="chart-card">
                            <h3>üìä ÏÉÅÍ¥ÄÍ≥ÑÏàò Îß§Ìä∏Î¶≠Ïä§</h3>
                            <div id="correlationMatrix"></div>
                        </div>

                        <div class="chart-card">
                            <h3>üìâ Î∞ïÏä§ÌîåÎ°Ø (Ï†êÏàò Î∂ÑÌè¨)</h3>
                            <div class="chart-container">
                                <canvas id="boxplotChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="insights" class="tab-content">
                    <div id="insightsContainer">
                        <!-- Ïù∏ÏÇ¨Ïù¥Ìä∏Í∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
                    </div>
                </div>

                <div id="data" class="tab-content">
                    <div class="data-table-container">
                        <h3>üìã ÌïÑÌÑ∞ÎßÅÎêú Îç∞Ïù¥ÌÑ∞ ÌÖåÏù¥Î∏î</h3>
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th onclick="sortTable(0)">ÏÑ±Î≥Ñ</th>
                                    <th onclick="sortTable(1)">Ïù∏Ï¢Ö/ÎØºÏ°±</th>
                                    <th onclick="sortTable(2)">Î∂ÄÎ™® ÍµêÏú°ÏàòÏ§Ä</th>
                                    <th onclick="sortTable(3)">Ï†êÏã¨</th>
                                    <th onclick="sortTable(4)">ÏãúÌóòÏ§ÄÎπÑ</th>
                                    <th onclick="sortTable(5)">ÏàòÌïô</th>
                                    <th onclick="sortTable(6)">ÏùΩÍ∏∞</th>
                                    <th onclick="sortTable(7)">Ïì∞Í∏∞</th>
                                    <th onclick="sortTable(8)">Ï¥ùÏ†ê</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                            </tbody>
                        </table>
                        <div class="pagination" id="pagination"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // CSV Îç∞Ïù¥ÌÑ∞ (Ïù∏ÎùºÏù∏)
        const csvData = `gender,race_ethnicity,parental_level_of_education,lunch,test_preparation_course,math_score,reading_score,writing_score
female,group B,bachelor's degree,standard,none,72,72,74
female,group C,some college,standard,completed,69,90,88
female,group B,master's degree,standard,none,90,95,93
male,group A,associate's degree,free/reduced,none,47,57,44
male,group C,some college,standard,none,76,78,75
female,group B,associate's degree,standard,none,71,83,78
female,group B,some college,standard,completed,88,95,92
male,group B,some college,free/reduced,none,40,43,39
male,group D,high school,free/reduced,completed,64,64,67
female,group B,high school,free/reduced,none,38,60,50
male,group C,associate's degree,standard,none,58,54,52
male,group D,associate's degree,standard,none,40,52,43
female,group B,high school,standard,none,65,81,73
male,group A,some college,standard,completed,78,72,70
female,group A,master's degree,standard,none,50,53,58
female,group C,some high school,standard,none,69,75,78
male,group C,high school,standard,none,88,89,86
female,group B,some high school,free/reduced,none,18,32,28
male,group C,master's degree,free/reduced,completed,46,42,46
female,group C,associate's degree,free/reduced,none,54,58,61
male,group D,high school,standard,none,66,69,63
female,group B,some college,free/reduced,completed,65,75,70
male,group D,some college,standard,none,44,54,53
female,group C,some high school,standard,none,69,73,73
male,group D,bachelor's degree,free/reduced,completed,74,71,80
male,group A,master's degree,free/reduced,none,73,74,72
male,group B,some college,standard,none,69,54,55
female,group C,bachelor's degree,standard,none,67,69,75
male,group C,high school,standard,none,70,70,65
female,group D,master's degree,standard,none,62,70,75
female,group D,some college,standard,none,69,74,74
female,group B,some college,standard,none,63,65,61
female,group E,master's degree,free/reduced,none,56,72,65
male,group D,some college,standard,none,40,42,38
male,group E,some college,standard,none,97,87,82
male,group E,associate's degree,standard,completed,81,81,79
female,group D,associate's degree,standard,none,74,81,83
female,group D,some high school,free/reduced,none,50,64,59
female,group D,associate's degree,free/reduced,completed,75,90,88
male,group B,associate's degree,free/reduced,none,57,56,57
male,group C,associate's degree,free/reduced,none,55,61,54
female,group C,associate's degree,standard,none,58,73,68
female,group B,associate's degree,standard,none,53,58,65
male,group B,some college,free/reduced,completed,59,65,66
female,group E,associate's degree,free/reduced,none,50,56,54
male,group B,associate's degree,standard,none,65,54,57
female,group A,associate's degree,standard,completed,55,65,62
female,group C,high school,standard,none,66,71,76
female,group D,associate's degree,free/reduced,completed,57,74,76
male,group C,high school,standard,completed,82,84,82
male,group E,some college,standard,none,53,55,48
male,group E,associate's degree,free/reduced,completed,77,69,68
male,group C,some college,standard,none,53,44,42
male,group D,high school,standard,none,88,78,75
female,group C,some high school,free/reduced,completed,71,84,87
female,group C,high school,free/reduced,none,33,41,43
female,group E,associate's degree,standard,completed,82,85,86
male,group D,associate's degree,standard,none,52,55,49
male,group D,some college,standard,completed,58,59,58
female,group C,some high school,free/reduced,none,0,17,10
male,group E,bachelor's degree,free/reduced,completed,79,74,72
male,group A,some high school,free/reduced,none,39,39,34
male,group A,associate's degree,free/reduced,none,62,61,55
female,group C,associate's degree,standard,none,69,80,71
female,group D,some high school,standard,none,59,58,59
male,group B,some high school,standard,none,67,64,61
male,group D,some high school,free/reduced,none,45,37,37
female,group C,some college,standard,none,60,72,74
male,group B,associate's degree,free/reduced,none,61,58,56
female,group C,associate's degree,standard,none,39,64,57
female,group D,some college,free/reduced,completed,58,63,73
male,group D,some college,standard,completed,63,55,63
female,group A,associate's degree,free/reduced,none,41,51,48
male,group C,some high school,free/reduced,none,61,57,56
male,group C,some high school,standard,none,49,49,41
male,group B,associate's degree,free/reduced,none,44,41,38
male,group E,some high school,standard,none,30,26,22
male,group A,bachelor's degree,standard,completed,80,78,81
female,group D,some high school,standard,completed,61,74,72
female,group E,master's degree,standard,none,62,68,68
female,group B,associate's degree,standard,none,47,49,50
male,group B,high school,free/reduced,none,49,45,45
male,group A,some college,free/reduced,completed,50,47,54
male,group E,associate's degree,standard,none,72,64,63
male,group D,high school,free/reduced,none,42,39,34
female,group C,some college,standard,none,73,80,82
female,group C,some college,free/reduced,none,76,83,88
female,group D,associate's degree,standard,none,71,71,74
female,group A,some college,standard,none,58,70,67
female,group D,some high school,standard,none,73,86,82
female,group C,bachelor's degree,standard,none,65,72,74
male,group C,high school,free/reduced,none,27,34,36
male,group C,high school,standard,none,71,79,71
male,group C,associate's degree,free/reduced,completed,43,45,50
female,group B,some college,standard,none,79,86,92
male,group C,associate's degree,free/reduced,completed,78,81,82
male,group B,some high school,standard,completed,65,66,62
female,group E,some college,standard,completed,63,72,70
female,group D,some college,free/reduced,none,58,67,62
female,group D,bachelor's degree,standard,none,65,67,62
male,group B,some college,standard,none,79,67,67
male,group D,bachelor's degree,standard,completed,68,74,74
female,group D,associate's degree,standard,none,85,91,89
male,group B,high school,standard,completed,60,44,47
male,group C,some college,standard,completed,98,86,90
female,group C,some college,standard,none,58,67,72
female,group D,master's degree,standard,none,87,100,100
male,group E,associate's degree,standard,completed,66,63,64
female,group B,associate's degree,free/reduced,none,52,76,70
female,group B,some high school,standard,none,70,64,72
female,group D,associate's degree,free/reduced,completed,77,89,98
male,group C,high school,standard,none,62,55,49
male,group A,associate's degree,standard,none,54,53,47
female,group D,some college,standard,none,51,58,54
female,group E,bachelor's degree,standard,completed,99,100,100
male,group C,high school,standard,none,84,77,74
female,group B,bachelor's degree,free/reduced,none,75,85,82
female,group D,bachelor's degree,standard,none,78,82,79
female,group D,some high school,standard,none,51,63,61
female,group C,some college,standard,none,55,69,65
female,group C,bachelor's degree,standard,completed,79,92,89
male,group B,associate's degree,standard,completed,91,89,92
female,group C,some college,standard,completed,88,93,93
male,group D,high school,free/reduced,none,63,57,56
male,group E,some college,standard,none,83,80,73
female,group B,high school,standard,none,87,95,86
male,group B,some high school,standard,none,72,68,67
male,group D,some college,standard,completed,65,77,74
male,group D,master's degree,standard,none,82,82,74
female,group A,bachelor's degree,standard,none,51,49,51
male,group D,master's degree,standard,none,89,84,82
male,group C,some high school,free/reduced,completed,53,37,40
male,group E,some college,free/reduced,completed,87,74,70
female,group C,some college,standard,completed,75,81,84
male,group D,bachelor's degree,free/reduced,completed,74,79,75
male,group C,bachelor's degree,standard,none,58,55,48
male,group B,some high school,standard,completed,51,54,41
male,group E,high school,standard,none,70,55,56
female,group C,associate's degree,standard,none,59,66,67
male,group D,some college,standard,completed,71,61,69
female,group D,some high school,standard,none,76,72,71
female,group C,some college,free/reduced,none,59,62,64
female,group E,some college,free/reduced,completed,42,55,54
male,group A,high school,standard,none,57,43,47
male,group D,some college,standard,none,88,73,78
female,group C,some college,free/reduced,none,22,39,33
male,group B,some high school,standard,none,88,84,75
male,group C,associate's degree,free/reduced,none,73,68,66
female,group D,bachelor's degree,standard,completed,68,75,81
male,group E,associate's degree,free/reduced,completed,100,100,93
male,group A,some high school,standard,completed,62,67,69
male,group A,bachelor's degree,standard,none,77,67,68
female,group B,associate's degree,standard,completed,59,70,66
male,group D,bachelor's degree,standard,none,54,49,47
male,group D,some high school,standard,none,62,67,61
female,group C,some college,standard,completed,70,89,88
female,group E,high school,free/reduced,completed,66,74,78
male,group B,some college,free/reduced,none,60,60,60
female,group B,associate's degree,standard,completed,61,86,87
male,group D,associate's degree,free/reduced,none,66,62,64
male,group B,associate's degree,free/reduced,completed,82,78,74
female,group E,some college,free/reduced,completed,75,88,85
male,group B,master's degree,free/reduced,none,49,53,52
male,group C,high school,standard,none,52,53,49
female,group E,master's degree,standard,none,81,92,91
female,group C,bachelor's degree,standard,completed,96,100,100
male,group C,high school,free/reduced,completed,53,51,51
female,group B,master's degree,free/reduced,completed,58,76,78
female,group B,high school,standard,completed,68,83,78
female,group C,some college,free/reduced,completed,67,75,70
male,group A,high school,standard,completed,72,73,74
male,group E,some high school,standard,none,94,88,78
female,group D,some college,standard,none,79,86,81
female,group C,associate's degree,standard,none,63,67,70
female,group C,bachelor's degree,free/reduced,completed,43,51,54
female,group C,master's degree,standard,completed,81,91,87
female,group B,high school,free/reduced,completed,46,54,58
female,group C,associate's degree,standard,completed,71,77,77
female,group B,master's degree,free/reduced,completed,52,70,62
female,group D,some high school,standard,completed,97,100,100
male,group C,master's degree,free/reduced,completed,62,68,75
female,group C,some college,free/reduced,none,46,64,66
female,group E,high school,standard,none,50,50,47
female,group D,associate's degree,standard,none,65,69,70
male,group C,some high school,free/reduced,completed,45,52,49
male,group C,associate's degree,free/reduced,completed,65,67,65
male,group E,high school,standard,none,80,76,65
male,group D,some high school,standard,completed,62,66,68
male,group B,some high school,free/reduced,none,48,52,45
female,group C,bachelor's degree,standard,none,77,88,87
female,group E,associate's degree,standard,none,66,65,69
male,group D,some college,standard,completed,76,83,79
female,group B,some high school,standard,none,62,64,66
male,group D,some college,standard,completed,77,62,62
female,group C,master's degree,standard,completed,69,84,85
male,group D,associate's degree,standard,none,61,55,52
male,group C,some high school,free/reduced,completed,59,69,65
male,group E,high school,free/reduced,none,55,56,51
female,group B,some college,free/reduced,none,45,53,55
female,group B,bachelor's degree,free/reduced,none,78,79,76
female,group C,associate's degree,standard,completed,67,84,86
female,group D,some college,free/reduced,none,65,81,77
male,group C,associate's degree,standard,none,69,77,69
female,group B,associate's degree,standard,none,57,69,68
male,group C,some college,standard,none,59,41,42
male,group D,some high school,standard,completed,74,71,78
male,group E,bachelor's degree,standard,none,82,62,62
male,group E,high school,standard,completed,81,80,76
female,group B,some college,free/reduced,none,74,81,76
female,group B,some college,free/reduced,none,58,61,66
male,group D,some high school,free/reduced,completed,80,79,79
male,group C,some college,free/reduced,none,35,28,27
female,group C,high school,free/reduced,none,42,62,60
male,group C,associate's degree,free/reduced,completed,60,51,56
male,group E,high school,standard,completed,87,91,81
male,group B,some high school,standard,completed,84,83,75
female,group E,associate's degree,free/reduced,completed,83,86,88
female,group C,high school,free/reduced,none,34,42,39
male,group B,high school,free/reduced,none,66,77,70
male,group B,some high school,standard,completed,61,56,56
female,group D,high school,standard,completed,56,68,74
male,group B,associate's degree,standard,none,87,85,73
female,group C,some high school,free/reduced,none,55,65,62
male,group D,some high school,standard,none,86,80,75
female,group B,associate's degree,standard,completed,52,66,73
female,group E,master's degree,free/reduced,none,45,56,54
female,group C,some college,standard,none,72,72,71
male,group D,high school,standard,none,57,50,54
male,group A,some high school,free/reduced,none,68,72,64
female,group C,some college,standard,completed,88,95,94
male,group D,some college,standard,none,76,64,66
male,group C,associate's degree,standard,none,46,43,42
female,group B,bachelor's degree,standard,none,67,86,83
male,group E,some high school,standard,none,92,87,78
male,group C,bachelor's degree,standard,completed,83,82,84
male,group D,associate's degree,standard,none,80,75,77
male,group D,bachelor's degree,free/reduced,none,63,66,67
female,group D,some high school,standard,completed,64,60,74
male,group B,some college,standard,none,54,52,51
male,group C,associate's degree,standard,none,84,80,80
male,group D,high school,free/reduced,completed,73,68,66
female,group E,bachelor's degree,standard,none,80,83,83
female,group D,high school,standard,none,56,52,55
male,group E,some college,standard,none,59,51,43
male,group D,some high school,standard,none,75,74,69
male,group C,associate's degree,standard,none,85,76,71
male,group E,associate's degree,standard,none,89,76,74
female,group B,high school,standard,completed,58,70,68
female,group B,high school,standard,none,65,64,62
male,group C,high school,standard,none,68,60,53
male,group A,some high school,standard,completed,47,49,49
female,group D,some college,free/reduced,none,71,83,83
female,group B,some high school,standard,completed,60,70,70
male,group D,master's degree,standard,none,80,80,72
male,group D,high school,standard,none,54,52,52
female,group E,some college,standard,none,62,73,70
female,group C,associate's degree,free/reduced,none,64,73,68
male,group C,associate's degree,standard,completed,78,77,77
female,group B,some college,standard,none,70,75,78
female,group C,master's degree,free/reduced,completed,65,81,81
female,group C,some high school,free/reduced,completed,64,79,77
male,group C,some college,standard,completed,79,79,78
female,group C,some high school,free/reduced,none,44,50,51
female,group E,high school,standard,none,99,93,90
male,group D,high school,standard,none,76,73,68
male,group D,some high school,free/reduced,none,59,42,41
female,group C,bachelor's degree,standard,none,63,75,81
female,group D,high school,standard,none,69,72,77
female,group D,associate's degree,standard,completed,88,92,95
female,group E,some college,free/reduced,none,71,76,70
male,group C,bachelor's degree,standard,none,69,63,61
male,group C,some college,standard,none,58,49,42
female,group D,associate's degree,free/reduced,none,47,53,58
female,group D,some college,standard,none,65,70,71
male,group B,some college,standard,completed,88,85,76
male,group C,bachelor's degree,standard,none,83,78,73
female,group C,some high school,standard,completed,85,92,93
female,group E,high school,standard,completed,59,63,75
female,group C,some high school,free/reduced,none,65,86,80
male,group B,bachelor's degree,free/reduced,none,73,56,57
male,group D,high school,standard,none,53,52,42
male,group D,high school,standard,none,45,48,46
female,group D,bachelor's degree,free/reduced,none,73,79,84
female,group D,some college,free/reduced,completed,70,78,78
female,group B,some high school,standard,none,37,46,46
male,group B,associate's degree,standard,completed,81,82,82
male,group E,associate's degree,standard,completed,97,82,88
female,group B,some high school,standard,none,67,89,82
male,group B,bachelor's degree,free/reduced,none,88,75,76
male,group E,some high school,standard,completed,77,76,77
male,group C,associate's degree,standard,none,76,70,68
male,group D,some high school,standard,none,86,73,70
male,group C,some high school,standard,completed,63,60,57
female,group E,bachelor's degree,standard,none,65,73,75
male,group D,high school,free/reduced,completed,78,77,80
male,group B,associate's degree,free/reduced,none,67,62,60
male,group A,some high school,standard,completed,46,41,43
male,group E,associate's degree,standard,completed,71,74,68
male,group C,high school,free/reduced,completed,40,46,50
male,group D,associate's degree,free/reduced,none,90,87,75
male,group A,some college,free/reduced,completed,81,78,81
male,group D,some high school,free/reduced,none,56,54,52
female,group C,associate's degree,standard,completed,67,84,81
male,group B,associate's degree,standard,none,80,76,64
female,group C,associate's degree,standard,completed,74,75,83
male,group A,some college,standard,none,69,67,69
male,group E,some college,standard,completed,99,87,81
male,group C,some high school,standard,none,51,52,44
female,group B,associate's degree,free/reduced,none,53,71,67
female,group D,high school,free/reduced,none,49,57,52
female,group B,associate's degree,standard,none,73,76,80
male,group B,bachelor's degree,standard,none,66,60,57
male,group D,bachelor's degree,standard,completed,67,61,68
female,group C,associate's degree,free/reduced,completed,68,67,69
female,group C,bachelor's degree,standard,completed,59,64,75
male,group C,high school,standard,none,71,66,65
female,group D,master's degree,standard,completed,77,82,91
male,group C,associate's degree,standard,none,83,72,78
male,group B,bachelor's degree,standard,none,63,71,69
female,group D,associate's degree,free/reduced,none,56,65,63
female,group C,high school,free/reduced,completed,67,79,84
female,group E,high school,standard,none,75,86,79
female,group C,some college,standard,none,71,81,80
female,group C,some high school,free/reduced,none,43,53,53
female,group C,high school,free/reduced,none,41,46,43
female,group C,some college,standard,none,82,90,94
male,group C,some college,standard,none,61,61,62
male,group A,some college,free/reduced,none,28,23,19
male,group C,associate's degree,standard,completed,82,75,77
female,group B,some high school,standard,none,41,55,51
male,group C,high school,standard,none,71,60,61
male,group C,associate's degree,standard,none,47,37,35
male,group E,associate's degree,standard,completed,62,56,53
male,group B,associate's degree,standard,none,90,78,81
female,group C,bachelor's degree,standard,none,83,93,95
female,group B,some college,free/reduced,none,61,68,66
male,group D,some high school,standard,completed,76,70,69
male,group C,associate's degree,standard,none,49,51,43
female,group B,some high school,free/reduced,none,24,38,27
female,group D,some high school,free/reduced,completed,35,55,60
male,group C,high school,free/reduced,none,58,61,52
female,group C,high school,standard,none,61,73,63
female,group B,high school,standard,completed,69,76,74
male,group D,associate's degree,standard,completed,67,72,67
male,group D,some college,standard,none,79,73,67
female,group C,high school,standard,none,72,80,75
male,group B,some college,standard,none,62,61,57
female,group C,bachelor's degree,standard,completed,77,94,95
male,group D,high school,free/reduced,none,75,74,66
male,group E,associate's degree,standard,none,87,74,76
female,group B,bachelor's degree,standard,none,52,65,69
male,group E,some college,standard,none,66,57,52
female,group C,some college,standard,completed,63,78,80
female,group C,associate's degree,standard,none,46,58,57
female,group C,some college,standard,none,59,71,70
female,group B,bachelor's degree,standard,none,61,72,70
male,group A,associate's degree,standard,none,63,61,61
female,group C,some college,free/reduced,completed,42,66,69
male,group D,some college,free/reduced,none,59,62,61
female,group D,some college,standard,none,80,90,89
female,group B,high school,standard,none,58,62,59
male,group B,some high school,standard,completed,85,84,78
female,group C,some college,standard,none,52,58,58
female,group D,some high school,free/reduced,none,27,34,32
male,group C,some college,standard,none,59,60,58
male,group A,bachelor's degree,free/reduced,completed,49,58,60
male,group C,high school,standard,completed,69,58,53
male,group C,bachelor's degree,free/reduced,none,61,66,61
female,group A,some high school,free/reduced,none,44,64,58
female,group D,some high school,standard,none,73,84,85
male,group E,some college,standard,none,84,77,71
female,group C,some college,free/reduced,completed,45,73,70
male,group D,some high school,standard,none,74,74,72
female,group D,some college,standard,completed,82,97,96
female,group D,bachelor's degree,standard,none,59,70,73
male,group E,associate's degree,free/reduced,none,46,43,41
female,group D,some high school,standard,none,80,90,82
female,group D,master's degree,free/reduced,completed,85,95,100
female,group A,some high school,standard,none,71,83,77
male,group A,bachelor's degree,standard,none,66,64,62
female,group B,associate's degree,standard,none,80,86,83
male,group C,associate's degree,standard,completed,87,100,95
male,group C,master's degree,free/reduced,none,79,81,71
female,group E,some high school,free/reduced,none,38,49,45
female,group A,some high school,free/reduced,none,38,43,43
female,group E,some college,standard,none,67,76,75
female,group E,bachelor's degree,standard,none,64,73,70
female,group C,associate's degree,free/reduced,none,57,78,67
female,group D,high school,standard,none,62,64,64
male,group D,master's degree,standard,none,73,70,75
male,group E,some high school,free/reduced,completed,73,67,59
female,group D,some college,standard,none,77,68,77
male,group E,some college,standard,none,76,67,67
male,group C,associate's degree,standard,completed,57,54,56
female,group C,some high school,standard,completed,65,74,77
male,group A,high school,free/reduced,none,48,45,41
female,group B,high school,free/reduced,none,50,67,63
female,group C,associate's degree,standard,none,85,89,95
male,group B,some high school,standard,none,74,63,57
male,group D,some high school,standard,none,60,59,54
female,group C,some high school,standard,completed,59,54,67
male,group A,some college,standard,none,53,43,43
female,group A,some college,free/reduced,none,49,65,55
female,group D,high school,standard,completed,88,99,100
female,group C,high school,standard,none,54,59,62
female,group C,some high school,standard,none,63,73,68
male,group B,associate's degree,standard,completed,65,65,63
female,group B,associate's degree,standard,none,82,80,77
female,group D,high school,free/reduced,completed,52,57,56
male,group D,associate's degree,standard,completed,87,84,85
female,group D,master's degree,standard,completed,70,71,74
male,group E,some college,standard,completed,84,83,78
male,group D,associate's degree,standard,none,71,66,60
male,group B,some high school,standard,completed,63,67,67
female,group C,bachelor's degree,free/reduced,completed,51,72,79
male,group E,high school,standard,none,84,73,69
male,group C,bachelor's degree,standard,completed,71,74,68
male,group C,associate's degree,standard,none,74,73,67
male,group D,some college,standard,none,68,59,62
male,group E,high school,free/reduced,completed,57,56,54
female,group C,associate's degree,free/reduced,completed,82,93,93
female,group D,high school,standard,completed,57,58,64
female,group D,master's degree,free/reduced,completed,47,58,67
female,group A,some high school,standard,completed,59,85,80
male,group B,some college,free/reduced,none,41,39,34
female,group C,some college,free/reduced,none,62,67,62
male,group C,bachelor's degree,standard,none,86,83,86
male,group C,some high school,free/reduced,none,69,71,65
male,group A,some high school,free/reduced,none,65,59,53
male,group C,some high school,free/reduced,none,68,63,54
male,group C,associate's degree,free/reduced,none,64,66,59
female,group C,high school,standard,none,61,72,70
male,group C,high school,standard,none,61,56,55
female,group A,some high school,free/reduced,none,47,59,50
male,group C,some high school,standard,none,73,66,66
male,group C,some college,free/reduced,completed,50,48,53
male,group D,associate's degree,standard,none,75,68,64
male,group D,associate's degree,free/reduced,none,75,66,73
male,group C,high school,standard,none,70,56,51
male,group D,some high school,standard,completed,89,88,82
female,group C,some college,standard,completed,67,81,79
female,group D,high school,standard,none,78,81,80
female,group A,some high school,free/reduced,none,59,73,69
female,group B,associate's degree,standard,none,73,83,76
male,group A,some high school,free/reduced,none,79,82,73
female,group C,some high school,standard,completed,67,74,77
male,group D,some college,free/reduced,none,69,66,60
male,group C,high school,standard,completed,86,81,80
male,group B,high school,standard,none,47,46,42
male,group B,associate's degree,standard,none,81,73,72
female,group C,some college,free/reduced,completed,64,85,85
female,group E,some college,standard,none,100,92,97
female,group C,associate's degree,free/reduced,none,65,77,74
male,group C,some college,free/reduced,none,65,58,49
female,group C,associate's degree,free/reduced,none,53,61,62
male,group C,bachelor's degree,free/reduced,none,37,56,47
female,group D,bachelor's degree,standard,none,79,89,89
male,group D,associate's degree,free/reduced,none,53,54,48
female,group E,bachelor's degree,standard,none,100,100,100
male,group B,high school,standard,completed,72,65,68
male,group C,bachelor's degree,free/reduced,none,53,58,55
male,group B,some college,free/reduced,none,54,54,45
female,group E,some college,standard,none,71,70,76
female,group C,some college,free/reduced,none,77,90,91
male,group A,bachelor's degree,standard,completed,75,58,62
female,group C,some college,standard,none,84,87,91
female,group D,associate's degree,free/reduced,none,26,31,38
male,group A,high school,free/reduced,completed,72,67,65
female,group A,high school,free/reduced,completed,77,88,85
male,group C,some college,standard,none,91,74,76
female,group C,associate's degree,standard,completed,83,85,90
female,group C,high school,standard,none,63,69,74
female,group C,associate's degree,standard,completed,68,86,84
female,group D,some high school,standard,none,59,67,61
female,group B,associate's degree,standard,completed,90,90,91
female,group D,bachelor's degree,standard,completed,71,76,83
male,group E,bachelor's degree,standard,completed,76,62,66
male,group D,associate's degree,standard,none,80,68,72
female,group D,master's degree,standard,none,55,64,70
male,group E,associate's degree,standard,none,76,71,67
male,group B,high school,standard,completed,73,71,68
female,group D,associate's degree,free/reduced,none,52,59,56
male,group C,some college,free/reduced,none,68,68,61
male,group A,high school,standard,none,59,52,46
female,group B,associate's degree,standard,none,49,52,54
male,group C,high school,standard,none,70,74,71
male,group D,some college,free/reduced,none,61,47,56
female,group C,associate's degree,free/reduced,none,60,75,74
male,group B,some high school,standard,completed,64,53,57
male,group A,associate's degree,free/reduced,completed,79,82,82
female,group A,associate's degree,free/reduced,none,65,85,76
female,group C,associate's degree,standard,none,64,64,70
female,group C,some college,standard,none,83,83,90
female,group C,bachelor's degree,standard,none,81,88,90
female,group B,high school,standard,none,54,64,68
male,group D,high school,standard,completed,68,64,66
female,group C,some college,standard,none,54,48,52
female,group D,some college,free/reduced,completed,59,78,76`;

        let allData = [];
        let filteredData = [];
        let charts = {};
        let currentPage = 1;
        const rowsPerPage = 20;
        let sortColumn = -1;
        let sortDirection = 1;

        // Îç∞Ïù¥ÌÑ∞ ÌååÏã±
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                const row = {};
                headers.forEach((header, index) => {
                    row[header.trim()] = values[index]?.trim();
                });
                row.math_score = parseInt(row.math_score) || 0;
                row.reading_score = parseInt(row.reading_score) || 0;
                row.writing_score = parseInt(row.writing_score) || 0;
                row.total_score = row.math_score + row.reading_score + row.writing_score;
                data.push(row);
            }
            return data;
        }

        // ÌïÑÌÑ∞ Ï†ÅÏö©
        function applyFilters() {
            const genderFilters = [];
            if (document.getElementById('filter-male').checked) genderFilters.push('male');
            if (document.getElementById('filter-female').checked) genderFilters.push('female');

            const raceFilters = Array.from(document.querySelectorAll('.race-filter:checked')).map(cb => cb.value);

            const lunchFilters = [];
            if (document.getElementById('filter-standard').checked) lunchFilters.push('standard');
            if (document.getElementById('filter-reduced').checked) lunchFilters.push('free/reduced');

            const prepFilters = [];
            if (document.getElementById('filter-prep-completed').checked) prepFilters.push('completed');
            if (document.getElementById('filter-prep-none').checked) prepFilters.push('none');

            const minScore = parseInt(document.getElementById('scoreMin').value);

            filteredData = allData.filter(row => {
                return genderFilters.includes(row.gender) &&
                       raceFilters.includes(row.race_ethnicity) &&
                       lunchFilters.includes(row.lunch) &&
                       prepFilters.includes(row.test_preparation_course) &&
                       (row.math_score >= minScore || row.reading_score >= minScore || row.writing_score >= minScore);
            });

            updateDashboard();
        }

        // ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
        function resetFilters() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
            document.getElementById('scoreMin').value = 0;
            document.getElementById('scoreMinLabel').textContent = 'ÏµúÏÜå: 0';
            filteredData = [...allData];
            updateDashboard();
        }

        // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateStats() {
            document.getElementById('totalStudents').textContent = filteredData.length;

            const avgMath = (filteredData.reduce((sum, r) => sum + r.math_score, 0) / filteredData.length).toFixed(1);
            const avgReading = (filteredData.reduce((sum, r) => sum + r.reading_score, 0) / filteredData.length).toFixed(1);
            const avgWriting = (filteredData.reduce((sum, r) => sum + r.writing_score, 0) / filteredData.length).toFixed(1);

            document.getElementById('avgMath').textContent = avgMath;
            document.getElementById('avgReading').textContent = avgReading;
            document.getElementById('avgWriting').textContent = avgWriting;
        }

        // Ï∞®Ìä∏ ÏÉâÏÉÅ
        const colors = {
            primary: ['#00d2ff', '#3a7bd5', '#00d9a5', '#ff6b6b', '#feca57', '#a55eea', '#26de81', '#fd79a8'],
            gradient: (ctx, start, end) => {
                const gradient = ctx.createLinearGradient(0, 0, 0, 300);
                gradient.addColorStop(0, start);
                gradient.addColorStop(1, end);
                return gradient;
            }
        };

        // Ï∞®Ïõê Ï∞®Ìä∏ ÏÉùÏÑ±
        function createDimensionChart() {
            const dimension = document.getElementById('primaryDimension').value;
            const scoreType = document.getElementById('scoreType').value;

            const groups = {};
            filteredData.forEach(row => {
                const key = row[dimension];
                if (!groups[key]) groups[key] = { math: [], reading: [], writing: [] };
                groups[key].math.push(row.math_score);
                groups[key].reading.push(row.reading_score);
                groups[key].writing.push(row.writing_score);
            });

            const labels = Object.keys(groups).sort();
            const datasets = [];

            if (scoreType === 'all' || scoreType === 'math_score') {
                datasets.push({
                    label: 'ÏàòÌïô',
                    data: labels.map(l => (groups[l].math.reduce((a, b) => a + b, 0) / groups[l].math.length).toFixed(1)),
                    backgroundColor: 'rgba(0, 210, 255, 0.7)',
                    borderColor: '#00d2ff',
                    borderWidth: 2
                });
            }
            if (scoreType === 'all' || scoreType === 'reading_score') {
                datasets.push({
                    label: 'ÏùΩÍ∏∞',
                    data: labels.map(l => (groups[l].reading.reduce((a, b) => a + b, 0) / groups[l].reading.length).toFixed(1)),
                    backgroundColor: 'rgba(58, 123, 213, 0.7)',
                    borderColor: '#3a7bd5',
                    borderWidth: 2
                });
            }
            if (scoreType === 'all' || scoreType === 'writing_score') {
                datasets.push({
                    label: 'Ïì∞Í∏∞',
                    data: labels.map(l => (groups[l].writing.reduce((a, b) => a + b, 0) / groups[l].writing.length).toFixed(1)),
                    backgroundColor: 'rgba(0, 217, 165, 0.7)',
                    borderColor: '#00d9a5',
                    borderWidth: 2
                });
            }

            if (charts.dimension) charts.dimension.destroy();
            charts.dimension = new Chart(document.getElementById('dimensionChart'), {
                type: 'bar',
                data: { labels, datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, beginAtZero: true, max: 100 }
                    }
                }
            });
        }

        // Î∂ÑÌè¨ ÌååÏù¥ Ï∞®Ìä∏
        function createDistributionPie() {
            const dimension = document.getElementById('primaryDimension').value;
            const groups = {};
            filteredData.forEach(row => {
                const key = row[dimension];
                groups[key] = (groups[key] || 0) + 1;
            });

            const labels = Object.keys(groups).sort();
            const data = labels.map(l => groups[l]);

            if (charts.distributionPie) charts.distributionPie.destroy();
            charts.distributionPie = new Chart(document.getElementById('distributionPie'), {
                type: 'doughnut',
                data: {
                    labels,
                    datasets: [{
                        data,
                        backgroundColor: colors.primary,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { color: '#ccc', padding: 15 } }
                    }
                }
            });
        }

        // ÌûàÏä§ÌÜ†Í∑∏Îû®
        function createHistogram() {
            const scoreType = document.getElementById('scoreType').value;
            const bins = Array(10).fill(0);

            filteredData.forEach(row => {
                let score;
                if (scoreType === 'all') {
                    score = Math.round((row.math_score + row.reading_score + row.writing_score) / 3);
                } else {
                    score = row[scoreType];
                }
                const binIndex = Math.min(Math.floor(score / 10), 9);
                bins[binIndex]++;
            });

            const labels = ['0-9', '10-19', '20-29', '30-39', '40-49', '50-59', '60-69', '70-79', '80-89', '90-100'];

            if (charts.histogram) charts.histogram.destroy();
            charts.histogram = new Chart(document.getElementById('histogramChart'), {
                type: 'bar',
                data: {
                    labels,
                    datasets: [{
                        label: 'ÌïôÏÉù Ïàò',
                        data: bins,
                        backgroundColor: 'rgba(0, 210, 255, 0.6)',
                        borderColor: '#00d2ff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, beginAtZero: true }
                    }
                }
            });
        }

        // ÏÑ±Î≥Ñ Ï∞®Ìä∏
        function createGenderChart() {
            const groups = { male: { math: [], reading: [], writing: [] }, female: { math: [], reading: [], writing: [] } };
            filteredData.forEach(row => {
                groups[row.gender].math.push(row.math_score);
                groups[row.gender].reading.push(row.reading_score);
                groups[row.gender].writing.push(row.writing_score);
            });

            const avg = (arr) => arr.length ? (arr.reduce((a, b) => a + b, 0) / arr.length).toFixed(1) : 0;

            if (charts.gender) charts.gender.destroy();
            charts.gender = new Chart(document.getElementById('genderChart'), {
                type: 'radar',
                data: {
                    labels: ['ÏàòÌïô', 'ÏùΩÍ∏∞', 'Ïì∞Í∏∞'],
                    datasets: [
                        {
                            label: 'ÎÇ®ÏÑ±',
                            data: [avg(groups.male.math), avg(groups.male.reading), avg(groups.male.writing)],
                            backgroundColor: 'rgba(0, 210, 255, 0.2)',
                            borderColor: '#00d2ff',
                            pointBackgroundColor: '#00d2ff'
                        },
                        {
                            label: 'Ïó¨ÏÑ±',
                            data: [avg(groups.female.math), avg(groups.female.reading), avg(groups.female.writing)],
                            backgroundColor: 'rgba(253, 121, 168, 0.2)',
                            borderColor: '#fd79a8',
                            pointBackgroundColor: '#fd79a8'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        r: {
                            ticks: { color: '#aaa', backdropColor: 'transparent' },
                            grid: { color: 'rgba(255,255,255,0.2)' },
                            pointLabels: { color: '#ccc' },
                            suggestedMin: 50,
                            suggestedMax: 80
                        }
                    }
                }
            });
        }

        // ÍµêÏú°ÏàòÏ§Ä Ï∞®Ìä∏
        function createEducationChart() {
            const order = ["some high school", "high school", "some college", "associate's degree", "bachelor's degree", "master's degree"];
            const groups = {};

            filteredData.forEach(row => {
                const edu = row.parental_level_of_education;
                if (!groups[edu]) groups[edu] = [];
                groups[edu].push((row.math_score + row.reading_score + row.writing_score) / 3);
            });

            const labels = order.filter(o => groups[o]);
            const data = labels.map(l => (groups[l].reduce((a, b) => a + b, 0) / groups[l].length).toFixed(1));

            if (charts.education) charts.education.destroy();
            charts.education = new Chart(document.getElementById('educationChart'), {
                type: 'line',
                data: {
                    labels: labels.map(l => l.replace("'s", "").replace("some ", "")),
                    datasets: [{
                        label: 'ÌèâÍ∑† Ï†êÏàò',
                        data,
                        borderColor: '#00d2ff',
                        backgroundColor: 'rgba(0, 210, 255, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, suggestedMin: 50, suggestedMax: 80 }
                    }
                }
            });
        }

        // Ï†êÏã¨ Ïú†Ìòï Ï∞®Ìä∏
        function createLunchChart() {
            const groups = { standard: [], 'free/reduced': [] };
            filteredData.forEach(row => {
                groups[row.lunch].push((row.math_score + row.reading_score + row.writing_score) / 3);
            });

            const labels = ['ÏùºÎ∞ò', 'Î¨¥Î£å/Ìï†Ïù∏'];
            const data = [
                groups.standard.length ? (groups.standard.reduce((a, b) => a + b, 0) / groups.standard.length).toFixed(1) : 0,
                groups['free/reduced'].length ? (groups['free/reduced'].reduce((a, b) => a + b, 0) / groups['free/reduced'].length).toFixed(1) : 0
            ];

            if (charts.lunch) charts.lunch.destroy();
            charts.lunch = new Chart(document.getElementById('lunchChart'), {
                type: 'bar',
                data: {
                    labels,
                    datasets: [{
                        label: 'ÌèâÍ∑† Ï†êÏàò',
                        data,
                        backgroundColor: ['rgba(0, 210, 255, 0.7)', 'rgba(255, 107, 107, 0.7)'],
                        borderColor: ['#00d2ff', '#ff6b6b'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, suggestedMin: 50, suggestedMax: 80 }
                    }
                }
            });
        }

        // ÏãúÌóò Ï§ÄÎπÑ Ï∞®Ìä∏
        function createPrepChart() {
            const groups = { completed: { math: [], reading: [], writing: [] }, none: { math: [], reading: [], writing: [] } };
            filteredData.forEach(row => {
                groups[row.test_preparation_course].math.push(row.math_score);
                groups[row.test_preparation_course].reading.push(row.reading_score);
                groups[row.test_preparation_course].writing.push(row.writing_score);
            });

            const avg = (arr) => arr.length ? (arr.reduce((a, b) => a + b, 0) / arr.length).toFixed(1) : 0;

            if (charts.prep) charts.prep.destroy();
            charts.prep = new Chart(document.getElementById('prepChart'), {
                type: 'bar',
                data: {
                    labels: ['ÏàòÌïô', 'ÏùΩÍ∏∞', 'Ïì∞Í∏∞'],
                    datasets: [
                        {
                            label: 'Ï§ÄÎπÑÍ≥ºÏ†ï ÏôÑÎ£å',
                            data: [avg(groups.completed.math), avg(groups.completed.reading), avg(groups.completed.writing)],
                            backgroundColor: 'rgba(0, 217, 165, 0.7)',
                            borderColor: '#00d9a5',
                            borderWidth: 2
                        },
                        {
                            label: 'ÎØ∏ÏàòÍ∞ï',
                            data: [avg(groups.none.math), avg(groups.none.reading), avg(groups.none.writing)],
                            backgroundColor: 'rgba(254, 202, 87, 0.7)',
                            borderColor: '#feca57',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, suggestedMin: 50, suggestedMax: 80 }
                    }
                }
            });
        }

        // Ïù∏Ï¢Ö/ÎØºÏ°± Ï∞®Ìä∏
        function createRaceChart() {
            const groups = {};
            ['group A', 'group B', 'group C', 'group D', 'group E'].forEach(g => {
                groups[g] = { math: [], reading: [], writing: [] };
            });

            filteredData.forEach(row => {
                if (groups[row.race_ethnicity]) {
                    groups[row.race_ethnicity].math.push(row.math_score);
                    groups[row.race_ethnicity].reading.push(row.reading_score);
                    groups[row.race_ethnicity].writing.push(row.writing_score);
                }
            });

            const avg = (arr) => arr.length ? (arr.reduce((a, b) => a + b, 0) / arr.length).toFixed(1) : 0;
            const labels = Object.keys(groups);

            if (charts.race) charts.race.destroy();
            charts.race = new Chart(document.getElementById('raceChart'), {
                type: 'bar',
                data: {
                    labels,
                    datasets: [
                        {
                            label: 'ÏàòÌïô',
                            data: labels.map(l => avg(groups[l].math)),
                            backgroundColor: 'rgba(0, 210, 255, 0.7)'
                        },
                        {
                            label: 'ÏùΩÍ∏∞',
                            data: labels.map(l => avg(groups[l].reading)),
                            backgroundColor: 'rgba(58, 123, 213, 0.7)'
                        },
                        {
                            label: 'Ïì∞Í∏∞',
                            data: labels.map(l => avg(groups[l].writing)),
                            backgroundColor: 'rgba(0, 217, 165, 0.7)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        x: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, suggestedMin: 40, suggestedMax: 80 }
                    }
                }
            });
        }

        // ÏÇ∞Ï†êÎèÑ
        function createScatterChart() {
            const mathVsReading = filteredData.map(r => ({ x: r.math_score, y: r.reading_score }));
            const mathVsWriting = filteredData.map(r => ({ x: r.math_score, y: r.writing_score }));

            if (charts.scatter) charts.scatter.destroy();
            charts.scatter = new Chart(document.getElementById('scatterChart'), {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'ÏàòÌïô vs ÏùΩÍ∏∞',
                            data: mathVsReading,
                            backgroundColor: 'rgba(0, 210, 255, 0.5)',
                            borderColor: '#00d2ff',
                            pointRadius: 4
                        },
                        {
                            label: 'ÏàòÌïô vs Ïì∞Í∏∞',
                            data: mathVsWriting,
                            backgroundColor: 'rgba(253, 121, 168, 0.5)',
                            borderColor: '#fd79a8',
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        x: { title: { display: true, text: 'ÏàòÌïô Ï†êÏàò', color: '#ccc' }, ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, min: 0, max: 100 },
                        y: { title: { display: true, text: 'Îã§Î•∏ Ï†êÏàò', color: '#ccc' }, ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, min: 0, max: 100 }
                    }
                }
            });
        }

        // ÏÉÅÍ¥ÄÍ≥ÑÏàò Í≥ÑÏÇ∞
        function pearsonCorrelation(x, y) {
            const n = x.length;
            const sumX = x.reduce((a, b) => a + b, 0);
            const sumY = y.reduce((a, b) => a + b, 0);
            const sumXY = x.reduce((total, xi, i) => total + xi * y[i], 0);
            const sumX2 = x.reduce((total, xi) => total + xi * xi, 0);
            const sumY2 = y.reduce((total, yi) => total + yi * yi, 0);

            const numerator = n * sumXY - sumX * sumY;
            const denominator = Math.sqrt((n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY));

            return denominator === 0 ? 0 : numerator / denominator;
        }

        // ÏÉÅÍ¥ÄÍ≥ÑÏàò Îß§Ìä∏Î¶≠Ïä§
        function createCorrelationMatrix() {
            const math = filteredData.map(r => r.math_score);
            const reading = filteredData.map(r => r.reading_score);
            const writing = filteredData.map(r => r.writing_score);

            const correlations = [
                ['', 'ÏàòÌïô', 'ÏùΩÍ∏∞', 'Ïì∞Í∏∞'],
                ['ÏàòÌïô', 1, pearsonCorrelation(math, reading), pearsonCorrelation(math, writing)],
                ['ÏùΩÍ∏∞', pearsonCorrelation(reading, math), 1, pearsonCorrelation(reading, writing)],
                ['Ïì∞Í∏∞', pearsonCorrelation(writing, math), pearsonCorrelation(writing, reading), 1]
            ];

            const container = document.getElementById('correlationMatrix');
            container.innerHTML = '';
            container.className = 'correlation-matrix';

            correlations.forEach((row, i) => {
                row.forEach((cell, j) => {
                    const div = document.createElement('div');
                    div.className = 'corr-cell';

                    if (i === 0 || j === 0) {
                        div.classList.add('corr-header');
                        div.textContent = cell;
                    } else {
                        const value = parseFloat(cell).toFixed(3);
                        div.textContent = value;
                        const hue = value * 120;
                        div.style.backgroundColor = `hsla(${hue}, 70%, 40%, 0.7)`;
                    }
                    container.appendChild(div);
                });
            });
        }

        // Î∞ïÏä§ÌîåÎ°Ø (Í∞ÑÎã® Î≤ÑÏ†Ñ)
        function createBoxplot() {
            const getStats = (arr) => {
                arr.sort((a, b) => a - b);
                const min = arr[0];
                const max = arr[arr.length - 1];
                const q1 = arr[Math.floor(arr.length * 0.25)];
                const median = arr[Math.floor(arr.length * 0.5)];
                const q3 = arr[Math.floor(arr.length * 0.75)];
                return { min, q1, median, q3, max };
            };

            const mathStats = getStats(filteredData.map(r => r.math_score));
            const readingStats = getStats(filteredData.map(r => r.reading_score));
            const writingStats = getStats(filteredData.map(r => r.writing_score));

            if (charts.boxplot) charts.boxplot.destroy();
            charts.boxplot = new Chart(document.getElementById('boxplotChart'), {
                type: 'bar',
                data: {
                    labels: ['ÏàòÌïô', 'ÏùΩÍ∏∞', 'Ïì∞Í∏∞'],
                    datasets: [
                        {
                            label: 'ÏµúÏÜå',
                            data: [mathStats.min, readingStats.min, writingStats.min],
                            backgroundColor: 'rgba(255, 107, 107, 0.7)'
                        },
                        {
                            label: 'Q1',
                            data: [mathStats.q1, readingStats.q1, writingStats.q1],
                            backgroundColor: 'rgba(254, 202, 87, 0.7)'
                        },
                        {
                            label: 'Ï§ëÏïôÍ∞í',
                            data: [mathStats.median, readingStats.median, writingStats.median],
                            backgroundColor: 'rgba(0, 210, 255, 0.7)'
                        },
                        {
                            label: 'Q3',
                            data: [mathStats.q3, readingStats.q3, writingStats.q3],
                            backgroundColor: 'rgba(0, 217, 165, 0.7)'
                        },
                        {
                            label: 'ÏµúÎåÄ',
                            data: [mathStats.max, readingStats.max, writingStats.max],
                            backgroundColor: 'rgba(165, 94, 234, 0.7)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#ccc' } } },
                    scales: {
                        x: { stacked: false, ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' } },
                        y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255,255,255,0.1)' }, min: 0, max: 100 }
                    }
                }
            });
        }

        // Ïù∏ÏÇ¨Ïù¥Ìä∏ ÏÉùÏÑ±
        function generateInsights() {
            const container = document.getElementById('insightsContainer');
            container.innerHTML = '';

            // ÏÑ±Î≥Ñ Ï∞®Ïù¥ Î∂ÑÏÑù
            const maleData = filteredData.filter(r => r.gender === 'male');
            const femaleData = filteredData.filter(r => r.gender === 'female');

            const maleAvg = maleData.length ? (maleData.reduce((s, r) => s + r.math_score, 0) / maleData.length).toFixed(1) : 0;
            const femaleAvgMath = femaleData.length ? (femaleData.reduce((s, r) => s + r.math_score, 0) / femaleData.length).toFixed(1) : 0;
            const femaleAvgReading = femaleData.length ? (femaleData.reduce((s, r) => s + r.reading_score, 0) / femaleData.length).toFixed(1) : 0;
            const maleAvgReading = maleData.length ? (maleData.reduce((s, r) => s + r.reading_score, 0) / maleData.length).toFixed(1) : 0;

            const insights = [
                {
                    title: 'ÏÑ±Î≥ÑÏóê Îî∞Î•∏ ÏÑ±Ï†Å Ï∞®Ïù¥',
                    content: `ÎÇ®ÌïôÏÉùÏùÄ ÏàòÌïôÏóêÏÑú ÌèâÍ∑† ${maleAvg}Ï†êÏúºÎ°ú Ïó¨ÌïôÏÉù(${femaleAvgMath}Ï†ê)Î≥¥Îã§ ${(maleAvg - femaleAvgMath).toFixed(1)}Ï†ê ÎÜíÏäµÎãàÎã§. Î∞òÎ©¥, ÏùΩÍ∏∞ÏóêÏÑúÎäî Ïó¨ÌïôÏÉùÏù¥ ${femaleAvgReading}Ï†êÏúºÎ°ú ÎÇ®ÌïôÏÉù(${maleAvgReading}Ï†ê)Î≥¥Îã§ ${(femaleAvgReading - maleAvgReading).toFixed(1)}Ï†ê ÎÜíÏäµÎãàÎã§.`
                },
                {
                    title: 'ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ïÏùò Ìö®Í≥º',
                    content: (() => {
                        const completed = filteredData.filter(r => r.test_preparation_course === 'completed');
                        const none = filteredData.filter(r => r.test_preparation_course === 'none');
                        const compAvg = completed.length ? ((completed.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / completed.length) / 3).toFixed(1) : 0;
                        const noneAvg = none.length ? ((none.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / none.length) / 3).toFixed(1) : 0;
                        return `ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ïÏùÑ ÏôÑÎ£åÌïú ÌïôÏÉùÎì§Ïùò ÌèâÍ∑† Ï†êÏàòÎäî ${compAvg}Ï†êÏúºÎ°ú, ÎØ∏ÏàòÍ∞ï ÌïôÏÉùÎì§(${noneAvg}Ï†ê)Î≥¥Îã§ ${(compAvg - noneAvg).toFixed(1)}Ï†ê ÎÜíÏäµÎãàÎã§. ÏãúÌóò Ï§ÄÎπÑÍ≥ºÏ†ïÏù¥ ÏÑ±Ï†Å Ìñ•ÏÉÅÏóê Ïú†ÏùòÎØ∏Ìïú Ìö®Í≥ºÍ∞Ä ÏûàÏùåÏùÑ Î≥¥Ïó¨Ï§çÎãàÎã§.`;
                    })()
                },
                {
                    title: 'Ï†êÏã¨ Ïú†ÌòïÍ≥º ÏÑ±Ï†ÅÏùò Í¥ÄÍ≥Ñ',
                    content: (() => {
                        const standard = filteredData.filter(r => r.lunch === 'standard');
                        const reduced = filteredData.filter(r => r.lunch === 'free/reduced');
                        const stdAvg = standard.length ? ((standard.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / standard.length) / 3).toFixed(1) : 0;
                        const redAvg = reduced.length ? ((reduced.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / reduced.length) / 3).toFixed(1) : 0;
                        return `ÏùºÎ∞ò Ï†êÏã¨ÏùÑ Î®πÎäî ÌïôÏÉùÎì§Ïùò ÌèâÍ∑† Ï†êÏàòÎäî ${stdAvg}Ï†êÏúºÎ°ú, Î¨¥Î£å/Ìï†Ïù∏ Ï†êÏã¨ ÌïôÏÉùÎì§(${redAvg}Ï†ê)Î≥¥Îã§ ${(stdAvg - redAvg).toFixed(1)}Ï†ê ÎÜíÏäµÎãàÎã§. Ïù¥Îäî ÏÇ¨ÌöåÍ≤ΩÏ†úÏ†Å ÏöîÏù∏Ïù¥ ÌïôÏóÖ ÏÑ±Ï∑®Ïóê ÏòÅÌñ•ÏùÑ ÎØ∏Ïπ† Ïàò ÏûàÏùåÏùÑ ÏãúÏÇ¨Ìï©ÎãàÎã§.`;
                    })()
                },
                {
                    title: 'Î∂ÄÎ™® ÍµêÏú°ÏàòÏ§ÄÏùò ÏòÅÌñ•',
                    content: (() => {
                        const masters = filteredData.filter(r => r.parental_level_of_education === "master's degree");
                        const highSchool = filteredData.filter(r => r.parental_level_of_education === "high school");
                        const mastersAvg = masters.length ? ((masters.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / masters.length) / 3).toFixed(1) : 0;
                        const hsAvg = highSchool.length ? ((highSchool.reduce((s, r) => s + r.math_score + r.reading_score + r.writing_score, 0) / highSchool.length) / 3).toFixed(1) : 0;
                        return `Î∂ÄÎ™®Í∞Ä ÏÑùÏÇ¨ ÌïôÏúÑÎ•º Í∞ÄÏßÑ ÌïôÏÉùÎì§Ïùò ÌèâÍ∑† Ï†êÏàòÎäî ${mastersAvg}Ï†êÏù¥Î©∞, Î∂ÄÎ™®Í∞Ä Í≥†Îì±ÌïôÍµê ÌïôÎ†•Ïù∏ ÌïôÏÉùÎì§ÏùÄ ${hsAvg}Ï†êÏûÖÎãàÎã§. Î∂ÄÎ™®Ïùò ÍµêÏú°ÏàòÏ§ÄÏù¥ ÎÜíÏùÑÏàòÎ°ù ÏûêÎÖÄÏùò ÌïôÏóÖ ÏÑ±Ï∑®ÎèÑÍ∞Ä ÎÜíÏùÄ Í≤ΩÌñ•Ïù¥ ÏûàÏäµÎãàÎã§.`;
                    })()
                },
                {
                    title: 'Ï†êÏàò Í∞Ñ ÏÉÅÍ¥ÄÍ¥ÄÍ≥Ñ',
                    content: (() => {
                        const math = filteredData.map(r => r.math_score);
                        const reading = filteredData.map(r => r.reading_score);
                        const writing = filteredData.map(r => r.writing_score);
                        const mrCorr = pearsonCorrelation(math, reading).toFixed(3);
                        const rwCorr = pearsonCorrelation(reading, writing).toFixed(3);
                        return `ÏàòÌïôÍ≥º ÏùΩÍ∏∞ Ï†êÏàòÏùò ÏÉÅÍ¥ÄÍ≥ÑÏàòÎäî ${mrCorr}Ïù¥Î©∞, ÏùΩÍ∏∞ÏôÄ Ïì∞Í∏∞ Ï†êÏàòÏùò ÏÉÅÍ¥ÄÍ≥ÑÏàòÎäî ${rwCorr}ÏûÖÎãàÎã§. Î™®Îì† Í≥ºÎ™©Ïù¥ ÏÑúÎ°ú Í∞ïÌïú ÏñëÏùò ÏÉÅÍ¥ÄÍ¥ÄÍ≥ÑÎ•º Î≥¥Ïù¥Î©∞, ÌäπÌûà ÏùΩÍ∏∞ÏôÄ Ïì∞Í∏∞ Í∞ÑÏùò ÏÉÅÍ¥ÄÍ¥ÄÍ≥ÑÍ∞Ä Í∞ÄÏû• ÎÜíÏäµÎãàÎã§.`;
                    })()
                }
            ];

            insights.forEach(insight => {
                const card = document.createElement('div');
                card.className = 'insight-card';
                card.innerHTML = `<h4>${insight.title}</h4><p>${insight.content}</p>`;
                container.appendChild(card);
            });
        }

        // ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const pageData = filteredData.slice(start, end);

            pageData.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.gender === 'male' ? 'ÎÇ®ÏÑ±' : 'Ïó¨ÏÑ±'}</td>
                    <td>${row.race_ethnicity}</td>
                    <td>${row.parental_level_of_education}</td>
                    <td>${row.lunch === 'standard' ? 'ÏùºÎ∞ò' : 'Î¨¥Î£å/Ìï†Ïù∏'}</td>
                    <td>${row.test_preparation_course === 'completed' ? 'ÏôÑÎ£å' : 'ÎØ∏ÏàòÍ∞ï'}</td>
                    <td>${row.math_score}</td>
                    <td>${row.reading_score}</td>
                    <td>${row.writing_score}</td>
                    <td>${row.total_score}</td>
                `;
                tbody.appendChild(tr);
            });

            updatePagination();
        }

        // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò
        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / rowsPerPage);
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const btn = document.createElement('button');
                btn.textContent = i;
                btn.className = i === currentPage ? 'active' : '';
                btn.onclick = () => {
                    currentPage = i;
                    updateTable();
                };
                pagination.appendChild(btn);
            }
        }

        // ÌÖåÏù¥Î∏î Ï†ïÎ†¨
        function sortTable(columnIndex) {
            if (sortColumn === columnIndex) {
                sortDirection *= -1;
            } else {
                sortColumn = columnIndex;
                sortDirection = 1;
            }

            const keys = ['gender', 'race_ethnicity', 'parental_level_of_education', 'lunch',
                          'test_preparation_course', 'math_score', 'reading_score', 'writing_score', 'total_score'];
            const key = keys[columnIndex];

            filteredData.sort((a, b) => {
                if (typeof a[key] === 'number') {
                    return (a[key] - b[key]) * sortDirection;
                }
                return a[key].localeCompare(b[key]) * sortDirection;
            });

            currentPage = 1;
            updateTable();
        }

        // ÌÉ≠ Ï†ÑÌôò
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // ÎåÄÏãúÎ≥¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
        function updateDashboard() {
            updateStats();
            createDimensionChart();
            createDistributionPie();
            createHistogram();
            createGenderChart();
            createEducationChart();
            createLunchChart();
            createPrepChart();
            createRaceChart();
            createScatterChart();
            createCorrelationMatrix();
            createBoxplot();
            generateInsights();
            updateTable();
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
        document.getElementById('primaryDimension').addEventListener('change', updateDashboard);
        document.getElementById('scoreType').addEventListener('change', updateDashboard);
        document.getElementById('scoreMin').addEventListener('input', function() {
            document.getElementById('scoreMinLabel').textContent = 'ÏµúÏÜå: ' + this.value;
        });

        // Ï¥àÍ∏∞Ìôî
        window.onload = function() {
            allData = parseCSV(csvData);
            filteredData = [...allData];
            updateDashboard();
        };
    </script>
</body>
</html>
